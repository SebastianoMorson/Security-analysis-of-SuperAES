---
annotation-target: "![[ImplementationNote.pdf]]"
---


>%%
>```annotation-json
>{"created":"2023-12-24T08:58:55.958Z","updated":"2023-12-24T08:58:55.958Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":1903,"end":2075},{"type":"TextQuoteSelector","exact":"any SuperSAM token will store information abouttheir respective access rights (in form of a ticket); the reader only verifies but does nothave to consult a central database","prefix":"dvantage of this system is that ","suffix":". Therefore our system guarantee"}]}]}
>```
>%%
>*%%PREFIX%%dvantage of this system is that%%HIGHLIGHT%% ==any SuperSAM token will store information abouttheir respective access rights (in form of a ticket); the reader only verifies but does nothave to consult a central database== %%POSTFIX%%. Therefore our system guarantee*
>%%LINK%%[[#^dhxser27nfv|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^dhxser27nfv


>%%
>```annotation-json
>{"created":"2023-12-24T09:04:52.339Z","updated":"2023-12-24T09:04:52.339Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":3085,"end":3190},{"type":"TextQuoteSelector","exact":"To prove authenticity we assume that each token holds some ID encrypted under thesystem master key (SMK).","prefix":" secure channel with the reader.","suffix":" The token has cryptographic fun"}]}]}
>```
>%%
>*%%PREFIX%%secure channel with the reader.%%HIGHLIGHT%% ==To prove authenticity we assume that each token holds some ID encrypted under thesystem master key (SMK).== %%POSTFIX%%The token has cryptographic fun*
>%%LINK%%[[#^voqm834ow4d|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^voqm834ow4d


>%%
>```annotation-json
>{"created":"2023-12-24T09:06:30.677Z","updated":"2023-12-24T09:06:30.677Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":3690,"end":3761},{"type":"TextQuoteSelector","exact":"There is a special class of readers in the field called Master Readers.","prefix":"yand decrypt ticket information.","suffix":" They have theability to update "}]}]}
>```
>%%
>*%%PREFIX%%yand decrypt ticket information.%%HIGHLIGHT%% ==There is a special class of readers in the field called Master Readers.== %%POSTFIX%%They have theability to update*
>%%LINK%%[[#^lie8ziau0dr|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^lie8ziau0dr


>%%
>```annotation-json
>{"created":"2023-12-24T09:06:37.562Z","updated":"2023-12-24T09:06:37.562Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":3775,"end":3810},{"type":"TextQuoteSelector","exact":"ability to update tickets on tokens","prefix":"ed Master Readers. They have the","suffix":". These reader will have, in add"}]}]}
>```
>%%
>*%%PREFIX%%ed Master Readers. They have the%%HIGHLIGHT%% ==ability to update tickets on tokens== %%POSTFIX%%. These reader will have, in add*
>%%LINK%%[[#^5si81iwv44k|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^5si81iwv44k


>%%
>```annotation-json
>{"created":"2023-12-24T09:12:09.660Z","updated":"2023-12-24T09:12:09.660Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":5025,"end":5112},{"type":"TextQuoteSelector","exact":"Because all core datais likely to be smaller than 128 bits, we will use AES in ECB mode","prefix":"eys as cryptographic primitive. ","suffix":".We follow RFC 3526 https://tool"}]}]}
>```
>%%
>*%%PREFIX%%eys as cryptographic primitive.%%HIGHLIGHT%% ==Because all core datais likely to be smaller than 128 bits, we will use AES in ECB mode== %%POSTFIX%%.We follow RFC 3526 https://tool*
>%%LINK%%[[#^nfmrkvdtrhc|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^nfmrkvdtrhc


>%%
>```annotation-json
>{"created":"2023-12-24T09:12:22.939Z","updated":"2023-12-24T09:12:22.939Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":5723,"end":5742},{"type":"TextQuoteSelector","exact":"The generator is 3.","prefix":"46C08 CA237327 FFFFFFFF FFFFFFFF","suffix":" This choice ensures that the DH"}]}]}
>```
>%%
>*%%PREFIX%%46C08 CA237327 FFFFFFFF FFFFFFFF%%HIGHLIGHT%% ==The generator is 3.== %%POSTFIX%%This choice ensures that the DH*
>%%LINK%%[[#^01mti0uyhhld|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^01mti0uyhhld


>%%
>```annotation-json
>{"created":"2023-12-24T09:12:50.180Z","updated":"2023-12-24T09:12:50.180Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":5885,"end":5965},{"type":"TextQuoteSelector","exact":"we will useAES as block cipher to implement CBC-MAC with fixed key equal to zero","prefix":"ange to a symmetric session key ","suffix":". This takesthe 1536 bit outcome"}]}]}
>```
>%%
>*%%PREFIX%%ange to a symmetric session key%%HIGHLIGHT%% ==we will useAES as block cipher to implement CBC-MAC with fixed key equal to zero== %%POSTFIX%%. This takesthe 1536 bit outcome*
>%%LINK%%[[#^2jh8ux3cfvc|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^2jh8ux3cfvc


>%%
>```annotation-json
>{"created":"2023-12-24T09:14:53.209Z","updated":"2023-12-24T09:14:53.209Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":7168,"end":7574},{"type":"TextQuoteSelector","exact":"Update System Master Key To ensure key agility there will be the option of re-placing a system master key smk on a token. The reader sends a new smk over to thetoken alongside with an encrypted ticket. The token then decrypts the encrypted ticketwith the new system master key and checks if the ticket is the same as the previouslyheld ticket. If so (implicit reader authentication), it accepts the new smk","prefix":"cket over to the SuperSAM token.","suffix":".2.4.1 Communication flowSuperSA"}]}]}
>```
>%%
>*%%PREFIX%%cket over to the SuperSAM token.%%HIGHLIGHT%% ==Update System Master Key To ensure key agility there will be the option of re-placing a system master key smk on a token. The reader sends a new smk over to thetoken alongside with an encrypted ticket. The token then decrypts the encrypted ticketwith the new system master key and checks if the ticket is the same as the previouslyheld ticket. If so (implicit reader authentication), it accepts the new smk== %%POSTFIX%%.2.4.1 Communication flowSuperSA*
>%%LINK%%[[#^1hfn4jg6w6p|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^1hfn4jg6w6p


>%%
>```annotation-json
>{"created":"2023-12-24T09:16:50.544Z","updated":"2023-12-24T09:16:50.544Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":8812,"end":8906},{"type":"TextQuoteSelector","exact":"The reader modules will be securely wall mounted, thereforewe assume that they will be secure.","prefix":" couldbe stolen by adversaries. ","suffix":"Adversaries may want to clone a "}]}]}
>```
>%%
>*%%PREFIX%%couldbe stolen by adversaries.%%HIGHLIGHT%% ==The reader modules will be securely wall mounted, thereforewe assume that they will be secure.== %%POSTFIX%%Adversaries may want to clone a*
>%%LINK%%[[#^6vjyhlm7nxf|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^6vjyhlm7nxf


>%%
>```annotation-json
>{"created":"2023-12-24T09:56:21.964Z","updated":"2023-12-24T09:56:21.964Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":10937,"end":10981},{"type":"TextQuoteSelector","exact":"We think that no SPA protection is necessary","prefix":"-to-right binary exponentiation.","suffix":". Because this DH works on ephem"}]}]}
>```
>%%
>*%%PREFIX%%-to-right binary exponentiation.%%HIGHLIGHT%% ==We think that no SPA protection is necessary== %%POSTFIX%%. Because this DH works on ephem*
>%%LINK%%[[#^b0p7cwrmxso|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^b0p7cwrmxso


>%%
>```annotation-json
>{"created":"2023-12-24T09:56:40.981Z","updated":"2023-12-24T09:56:40.981Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":11088,"end":11173},{"type":"TextQuoteSelector","exact":"Also because wehave such large primes, DPA style attacks would be extremely difficult","prefix":"tyle attacks will be a problem. ","suffix":". Therefore we donot plan to imp"}]}]}
>```
>%%
>*%%PREFIX%%tyle attacks will be a problem.%%HIGHLIGHT%% ==Also because wehave such large primes, DPA style attacks would be extremely difficult== %%POSTFIX%%. Therefore we donot plan to imp*
>%%LINK%%[[#^kqjfmh16uq7|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^kqjfmh16uq7


>%%
>```annotation-json
>{"created":"2023-12-24T09:57:10.485Z","updated":"2023-12-24T09:57:10.485Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":11545,"end":11619},{"type":"TextQuoteSelector","exact":"we believe that it is cryptographically secure because it has a long cycle","prefix":"iginal Github implementationand ","suffix":".We believe that this implementa"}]}]}
>```
>%%
>*%%PREFIX%%iginal Github implementationand%%HIGHLIGHT%% ==we believe that it is cryptographically secure because it has a long cycle== %%POSTFIX%%.We believe that this implementa*
>%%LINK%%[[#^nhl7im5qrh|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^nhl7im5qrh


>%%
>```annotation-json
>{"created":"2023-12-24T09:58:24.951Z","updated":"2023-12-24T09:58:24.951Z","document":{"title":"ImplementationNote.pdf","link":[{"href":"urn:x-pdf:c6426a13714b755726be19229517c3a3"},{"href":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf"}],"documentFingerprint":"c6426a13714b755726be19229517c3a3"},"uri":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","target":[{"source":"vault:/APPUNTI MAGISTRALE/ATC2/SUPERSAM_resources/pdf/ImplementationNote.pdf","selector":[{"type":"TextPositionSelector","start":11356,"end":11481},{"type":"TextQuoteSelector","exact":"We have alsotested the PRNG and it satisfies the serial test; therefore it is clear that the resultingdistribution is uniform","prefix":"ion for functional correctness. ","suffix":". The PRNG was taken from the or"}]}]}
>```
>%%
>*%%PREFIX%%ion for functional correctness.%%HIGHLIGHT%% ==We have alsotested the PRNG and it satisfies the serial test; therefore it is clear that the resultingdistribution is uniform== %%POSTFIX%%. The PRNG was taken from the or*
>%%LINK%%[[#^houik0g99sm|show annotation]]
>%%COMMENT%%
>
>%%TAGS%%
>
^houik0g99sm
